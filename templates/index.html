{% extends "base.html" %}

{% block title %}æ²³å—å“è¿œæ£€æµ‹æœ‰é™å…¬å¸å†…ç½‘{% endblock %}

{% block breadcrumb %}
    <!-- é¦–é¡µä¸éœ€è¦é¢åŒ…å±‘å¯¼èˆª -->
{% endblock %}

{% block content %}
<div class="container">
    <main class="main-content">
        <!-- æ¬¢è¿æ¨ªå¹… -->
        <section class="welcome-banner">
            <div class="banner-content">
                <h1 class="banner-title">æ¬¢è¿ä½¿ç”¨æ²³å—å“è¿œæ£€æµ‹æœ‰é™å…¬å¸ååŒåŠå…¬å¹³å°</h1>
                <p class="banner-subtitle">ä¸€ç«™å¼è®¿é—®æ‰€æœ‰å·¥ä½œèµ„æºå’Œå·¥å…·</p>
            </div>
        </section>

        <div class="home-layout">
            <!-- å·¦ä¾§å†…å®¹åŒºåŸŸ -->
            <div class="home-left">
                <!-- å¿«é€Ÿå…¥å£ -->
                <section class="quick-links">
                    <h2>å¿«é€Ÿå…¥å£</h2>
                    <div class="links-grid">
                        {% for link in get_quick_links() %}
                        <a href="{{ link.url }}" class="link-card">
                            <span class="icon">{{ link.icon }}</span>
                            <span class="name">{{ link.name }}</span>
                        </a>
                        {% endfor %}
                    </div>
                </section>

                <!-- é€šçŸ¥å…¬å‘Š -->
                <section class="notifications">
                    <h2>æœ€æ–°é€šçŸ¥</h2>
                    <div class="notification-list">
                        {% for notice in notifications %}
                        <a href="{{ url_for('notification_detail', notification_id=notice.id) }}" class="notification-link">
                            <div class="notification-item {% if notice.is_top %}top-notification{% endif %}">
                                {% if notice.is_top %}
                                <div class="top-indicator">ç½®é¡¶</div>
                                {% endif %}
                                <div class="notice-content">
                                    <div class="notice-title">{{ notice.title }}</div>
                                    <div class="notice-meta">
                                        <span class="publisher">{{ notice.publisher.username }}</span>
                                        <span class="date">{{ format_local_time(notice.publish_time) }}</span>
                                    </div>
                                </div>
                            </div>
                        </a>
                        {% endfor %}
                    </div>
                    <div class="view-all">
                        <a href="{{ url_for('notifications_list') }}">æŸ¥çœ‹å…¨éƒ¨é€šçŸ¥</a>
                    </div>
                </section>
            </div>

            <!-- å³ä¾§å¾…åŠäº‹é¡¹æ‚¬æµ®åŒºåŸŸ -->
            <div class="home-right">
                <section class="todo-sidebar">
                    <h2>æˆ‘çš„å¾…åŠ</h2>
                    <div class="todo-list">
                        <!-- å¾…å®¡æ‰¹ç”³è¯· -->
                        {% if current_user.has_permission('approve_requests') %}
                        <a href="{{ url_for('request_list') }}" class="todo-item">
                            <div class="todo-icon">ğŸ“‹</div>
                            <div class="todo-content">
                                <div class="todo-title">å¾…å®¡æ‰¹ç”³è¯·</div>
                                <div class="todo-count">{{ pending_requests_count }} ä¸ª</div>
                            </div>
                        </a>
                        {% endif %}

                        <!-- æœªè¯»æ¶ˆæ¯ -->
                        <a href="{{ url_for('messages_list') }}" class="todo-item">
                            <div class="todo-icon">ğŸ“¢</div>
                            <div class="todo-content">
                                <div class="todo-title">æœªè¯»æ¶ˆæ¯</div>
                                <div class="todo-count">{{ unread_messages_count }} æ¡</div>
                            </div>
                        </a>

                        <!-- åº“å­˜å‘Šè­¦ -->
                        <a href="{{ url_for('supplies_list') }}" class="todo-item">
                            <div class="todo-icon">âš ï¸</div>
                            <div class="todo-content">
                                <div class="todo-title">åº“å­˜å‘Šè­¦</div>
                                <div class="todo-count">{{ low_stock_count }} ä¸ª</div>
                            </div>
                        </a>
                    </div>
                </section>
            </div>
        </div>
    </main>
</div>
{% endblock %}